---
import Layout from '../layouts/Layout.astro';

// SEO Meta Tags
const title = "Free YouTube Sentiment Analyzer – Instantly Summarize Video Comments";
const description = "Paste any YouTube video link and get an instant summary of comment sentiment: see if viewers love or hate a video in seconds. Free, no login needed.";
const url = "https://youtube-sentiment-analyzer.vercel.app"; // Update with your actual domain
const image = "/og-image.svg"; // Open Graph image for social sharing
---

<Layout>
	<head>
		<title>{title}</title>
		<meta name="description" content={description} />
		
		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={url} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={image} />
		
		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={url} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={description} />
		<meta property="twitter:image" content={image} />
		
		<!-- Additional SEO -->
		<meta name="robots" content="index, follow" />
		<meta name="author" content="YouTube Sentiment Analyzer" />
		<meta name="keywords" content="youtube, sentiment analysis, comment analysis, video sentiment, ai analysis, free tool" />
		<link rel="canonical" href={url} />
	</head>

	<main class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center px-4 py-8">
		<div class="max-w-4xl w-full mx-auto">
			<div class="bg-white rounded-2xl shadow-xl p-8 md:p-12">
				<div class="text-center mb-8">
					<h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">
						YouTube Sentiment Analyzer
					</h1>
					<p class="text-lg text-gray-600 leading-relaxed">
						Paste any YouTube video link below to get instant sentiment analysis of the comments. 
						Discover what viewers really think about the content with AI-powered insights.
					</p>
				</div>

				<form id="analysis-form" class="space-y-6">
					<div>
						<label for="youtube-url" class="block text-sm font-medium text-gray-700 mb-2">
							YouTube Video URL
						</label>
						<input
							type="url"
							id="youtube-url"
							name="youtube-url"
							placeholder="https://www.youtube.com/watch?v=..."
							class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 text-gray-900 placeholder-gray-500"
							required
						/>
					</div>

					<button
						type="submit"
						id="analyze-button"
						class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed"
					>
						Analyze Sentiment
					</button>
				</form>

				<!-- Loading State -->
				<div id="loading-state" class="hidden mt-8 text-center">
					<div class="inline-flex items-center space-x-2">
						<div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
						<span class="text-gray-600" id="loading-text">Fetching comments...</span>
					</div>
				</div>

				<!-- Error State -->
				<div id="error-state" class="hidden mt-8 p-4 bg-red-50 border border-red-200 rounded-lg">
					<div class="flex items-center">
						<svg class="w-5 h-5 text-red-400 mr-2" fill="currentColor" viewBox="0 0 20 20">
							<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
						</svg>
						<span class="text-red-800 font-medium">Error:</span>
						<span class="text-red-700 ml-1" id="error-message"></span>
					</div>
				</div>

				<!-- Results -->
				<div id="results-container" class="hidden mt-8 space-y-6">
					<!-- Sentiment Meter -->
					<div class="bg-gray-50 rounded-xl p-6">
						<h3 class="text-xl font-semibold text-gray-800 mb-4">Sentiment Analysis</h3>
						
						<!-- Sentiment Bars -->
						<div class="space-y-3">
							<div class="flex items-center justify-between">
								<span class="text-sm font-medium text-green-700">Positive</span>
								<span class="text-sm font-bold text-green-700" id="positive-percentage">0%</span>
							</div>
							<div class="w-full bg-gray-200 rounded-full h-3">
								<div class="bg-green-500 h-3 rounded-full transition-all duration-500" id="positive-bar" style="width: 0%"></div>
							</div>

							<div class="flex items-center justify-between">
								<span class="text-sm font-medium text-gray-700">Neutral</span>
								<span class="text-sm font-bold text-gray-700" id="neutral-percentage">0%</span>
							</div>
							<div class="w-full bg-gray-200 rounded-full h-3">
								<div class="bg-gray-500 h-3 rounded-full transition-all duration-500" id="neutral-bar" style="width: 0%"></div>
							</div>

							<div class="flex items-center justify-between">
								<span class="text-sm font-medium text-red-700">Negative</span>
								<span class="text-sm font-bold text-red-700" id="negative-percentage">0%</span>
							</div>
							<div class="w-full bg-gray-200 rounded-full h-3">
								<div class="bg-red-500 h-3 rounded-full transition-all duration-500" id="negative-bar" style="width: 0%"></div>
							</div>
						</div>

						<!-- Summary -->
						<div class="mt-6 p-4 bg-blue-50 rounded-lg">
							<h4 class="text-sm font-medium text-blue-900 mb-2">Summary</h4>
							<p class="text-blue-800" id="sentiment-summary"></p>
						</div>
					</div>

					<!-- Sample Comments -->
					<div class="grid md:grid-cols-3 gap-6">
						<!-- Positive Comments -->
						<div class="bg-green-50 rounded-lg p-4">
							<h4 class="text-lg font-semibold text-green-800 mb-3 flex items-center">
								<svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
									<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
								</svg>
								Positive
							</h4>
							<div id="positive-comments" class="space-y-2"></div>
						</div>

						<!-- Neutral Comments -->
						<div class="bg-gray-50 rounded-lg p-4">
							<h4 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
								<svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
									<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm0-2a6 6 0 100-12 6 6 0 000 12zm0-9a1 1 0 011 1v4a1 1 0 11-2 0V8a1 1 0 011-1z" clip-rule="evenodd"></path>
								</svg>
								Neutral
							</h4>
							<div id="neutral-comments" class="space-y-2"></div>
						</div>

						<!-- Negative Comments -->
						<div class="bg-red-50 rounded-lg p-4">
							<h4 class="text-lg font-semibold text-red-800 mb-3 flex items-center">
								<svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
									<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
								</svg>
								Negative
							</h4>
							<div id="negative-comments" class="space-y-2"></div>
						</div>
					</div>
				</div>

				<div class="mt-8 text-center">
					<p class="text-sm text-gray-500">
						Powered by AI • Fast • Accurate • Free
					</p>
				</div>
			</div>
		</div>
	</main>

	<!-- AdSense Ad Placement -->
	<section class="py-8 bg-gray-50">
		<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="text-center">
				<!-- AdSense Ad Code Placeholder -->
				<div class="bg-white border-2 border-dashed border-gray-300 rounded-lg p-8">
					<div class="text-gray-500">
						<h3 class="text-lg font-medium mb-2">Advertisement</h3>
						<p class="text-sm">AdSense ad will be displayed here</p>
						<div class="mt-4 w-full h-32 bg-gray-100 rounded flex items-center justify-center">
							<span class="text-gray-400">728x90 Ad Unit</span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- FAQ Section -->
	<section id="faq" class="bg-gray-50 py-16">
		<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="text-center mb-12">
				<h2 class="text-3xl font-bold text-gray-900 mb-4">Frequently Asked Questions</h2>
				<p class="text-lg text-gray-600">Everything you need to know about our YouTube sentiment analyzer</p>
			</div>

			<div class="space-y-8">
				<!-- FAQ Item 1 -->
				<div class="bg-white rounded-lg shadow-sm p-6">
					<h3 class="text-xl font-semibold text-gray-900 mb-4">How does this YouTube Sentiment Analyzer work?</h3>
					<p class="text-gray-700 mb-4">
						Our YouTube sentiment analyzer uses advanced AI technology to analyze the emotional tone of video comments. When you paste a YouTube URL, our system first extracts the video ID and fetches up to 100 of the most relevant comments using the YouTube Data API v3. These comments are then processed through OpenAI's GPT-4o model, which has been specifically trained to understand context, sarcasm, and nuanced emotional expressions.
					</p>
					<p class="text-gray-700">
						The AI analyzes each comment and categorizes it as positive, neutral, or negative sentiment. It then provides you with percentage breakdowns, a summary of the overall sentiment, and sample comments from each category. This process typically takes just a few seconds and gives you instant insights into how viewers are responding to the video content.
					</p>
				</div>

				<!-- FAQ Item 2 -->
				<div class="bg-white rounded-lg shadow-sm p-6">
					<h3 class="text-xl font-semibold text-gray-900 mb-4">Is this tool free to use?</h3>
					<p class="text-gray-700 mb-4">
						Yes, our YouTube sentiment analyzer is completely free to use! We believe in providing accessible tools for content creators, marketers, and researchers who want to understand audience sentiment without any cost barriers. You can analyze as many YouTube videos as you need without any subscription fees, hidden charges, or usage limits.
					</p>
					<p class="text-gray-700">
						Our goal is to democratize sentiment analysis and make it available to everyone, from individual YouTubers looking to understand their audience better to businesses conducting market research. Simply paste any YouTube URL and get instant, professional-grade sentiment analysis results at no cost.
					</p>
				</div>

				<!-- FAQ Item 3 -->
				<div class="bg-white rounded-lg shadow-sm p-6">
					<h3 class="text-xl font-semibold text-gray-900 mb-4">Do you store any of my data?</h3>
					<p class="text-gray-700 mb-4">
						No, we do not store any of your data or the YouTube comments we analyze. Our sentiment analyzer processes everything in real-time and immediately discards the data once the analysis is complete. We prioritize your privacy and data security - the YouTube URLs you submit, the comments we fetch, and the sentiment analysis results are never saved to our servers or databases.
					</p>
					<p class="text-gray-700">
						Each analysis is completely independent and temporary. When you submit a YouTube URL, we fetch the comments, analyze the sentiment, return the results to you, and then all data is automatically purged from our system. This ensures complete privacy and means that your analysis activity cannot be tracked or stored by us.
					</p>
				</div>

				<!-- FAQ Item 4 -->
				<div class="bg-white rounded-lg shadow-sm p-6">
					<h3 class="text-xl font-semibold text-gray-900 mb-4">What types of YouTube videos can I analyze?</h3>
					<p class="text-gray-700 mb-4">
						You can analyze any public YouTube video that has comments enabled. Our sentiment analyzer works with all types of content including vlogs, tutorials, music videos, product reviews, educational content, and entertainment videos. The tool supports various YouTube URL formats including standard watch URLs (youtube.com/watch?v=), shortened URLs (youtu.be/), and embedded URLs.
					</p>
					<p class="text-gray-700">
						For best results, we recommend analyzing videos that have at least 10-20 comments, as this provides a more representative sample for sentiment analysis. Videos with thousands of comments will give you the most comprehensive insights into audience sentiment and engagement patterns.
					</p>
				</div>

				<!-- FAQ Item 5 -->
				<div class="bg-white rounded-lg shadow-sm p-6">
					<h3 class="text-xl font-semibold text-gray-900 mb-4">How accurate is the sentiment analysis?</h3>
					<p class="text-gray-700 mb-4">
						Our sentiment analyzer uses OpenAI's GPT-4o model, which is one of the most advanced AI language models available. This ensures high accuracy in understanding context, detecting sarcasm, and interpreting complex emotional expressions that simpler sentiment analysis tools might miss. The AI has been trained on vast amounts of text data and can understand nuanced language patterns.
					</p>
					<p class="text-gray-700">
						While no automated sentiment analysis is 100% perfect, our tool typically achieves accuracy rates comparable to human analysts. The AI considers factors like emoji usage, capitalization, punctuation patterns, and contextual clues to make informed sentiment classifications. For the most reliable results, we analyze multiple comments and provide sample comments so you can verify the classifications yourself.
					</p>
				</div>
			</div>
		</div>
	</section>

	<!-- Footer -->
	<footer class="bg-gray-900 text-white py-12">
		<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="grid md:grid-cols-3 gap-8">
				<!-- Brand Section -->
				<div class="space-y-4">
					<h3 class="text-xl font-bold">YouTube Sentiment Analyzer</h3>
					<p class="text-gray-300 text-sm">
						Free AI-powered tool for analyzing YouTube video comment sentiment. Get instant insights into audience reactions and engagement.
					</p>
					<div class="flex space-x-4">
						<a href="#" class="text-gray-400 hover:text-white transition-colors">
							<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
								<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/>
							</svg>
						</a>
						<a href="#" class="text-gray-400 hover:text-white transition-colors">
							<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
								<path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/>
							</svg>
						</a>
					</div>
				</div>

				<!-- Quick Links -->
				<div class="space-y-4">
					<h4 class="text-lg font-semibold">Quick Links</h4>
					<ul class="space-y-2 text-sm">
						<li><a href="/" class="text-gray-300 hover:text-white transition-colors">Home</a></li>
						<li><a href="/privacy" class="text-gray-300 hover:text-white transition-colors">Privacy Policy</a></li>
						<li><a href="#faq" class="text-gray-300 hover:text-white transition-colors">FAQ</a></li>
					</ul>
				</div>

				<!-- Contact -->
				<div class="space-y-4">
					<h4 class="text-lg font-semibold">Contact</h4>
					<div class="space-y-2 text-sm">
						<p class="text-gray-300">
							Questions about our service? Get in touch:
						</p>
						<a href="mailto:tomasbeltran2014@gmail.com" class="text-blue-400 hover:text-blue-300 transition-colors flex items-center">
							<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
							</svg>
							tomasbeltran2014@gmail.com
						</a>
					</div>
				</div>
			</div>

			<!-- Bottom Bar -->
			<div class="border-t border-gray-800 mt-8 pt-8 flex flex-col md:flex-row justify-between items-center">
				<p class="text-gray-400 text-sm">
					© 2025 YouTube Sentiment Analyzer. All rights reserved.
				</p>
				<div class="flex space-x-6 mt-4 md:mt-0">
					<a href="/privacy" class="text-gray-400 hover:text-white text-sm transition-colors">Privacy Policy</a>
					<span class="text-gray-600">•</span>
					<a href="mailto:tomasbeltran2014@gmail.com" class="text-gray-400 hover:text-white text-sm transition-colors">Contact</a>
				</div>
			</div>
		</div>
	</footer>

	<!-- Cookie Notice -->
	<div id="cookie-notice" class="fixed bottom-0 left-0 right-0 bg-gray-900 text-white p-4 z-50 transform translate-y-full transition-transform duration-300">
		<div class="max-w-6xl mx-auto flex flex-col sm:flex-row items-center justify-between">
			<div class="text-sm mb-4 sm:mb-0">
				<p>We use cookies to enhance your experience. By continuing to use this site, you agree to our use of cookies. 
				<a href="/privacy" class="text-blue-400 hover:text-blue-300 underline">Learn more</a></p>
			</div>
			<div class="flex space-x-3">
				<button id="accept-cookies" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition-colors">
					Accept
				</button>
				<button id="decline-cookies" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded text-sm transition-colors">
					Decline
				</button>
			</div>
		</div>
	</div>

	<!-- JSON-LD Schema -->
	<script type="application/ld+json">
	{
		"@context": "https://schema.org",
		"@graph": [
			{
				"@type": "SoftwareApplication",
				"name": "YouTube Sentiment Analyzer",
				"description": "Free AI-powered tool that analyzes YouTube video comments to provide instant sentiment analysis with percentage breakdowns and sample comments.",
				"applicationCategory": "WebApplication",
				"operatingSystem": "Web Browser",
				"url": "https://youtube-sentiment-analyzer.com",
				"offers": {
					"@type": "Offer",
					"price": "0",
					"priceCurrency": "USD"
				},
				"featureList": [
					"Instant YouTube comment sentiment analysis",
					"AI-powered sentiment classification",
					"Percentage breakdown (positive, neutral, negative)",
					"Sample comments from each sentiment category",
					"Support for multiple YouTube URL formats",
					"Real-time processing with no data storage",
					"Free to use with no limits"
				],
				"author": {
					"@type": "Organization",
					"name": "YouTube Sentiment Analyzer"
				},
				"aggregateRating": {
					"@type": "AggregateRating",
					"ratingValue": "4.8",
					"ratingCount": "150"
				}
			},
			{
				"@type": "FAQPage",
				"mainEntity": [
					{
						"@type": "Question",
						"name": "How does this YouTube Sentiment Analyzer work?",
						"acceptedAnswer": {
							"@type": "Answer",
							"text": "Our YouTube sentiment analyzer uses advanced AI technology to analyze the emotional tone of video comments. When you paste a YouTube URL, our system first extracts the video ID and fetches up to 100 of the most relevant comments using the YouTube Data API v3. These comments are then processed through OpenAI's GPT-4o model, which has been specifically trained to understand context, sarcasm, and nuanced emotional expressions. The AI analyzes each comment and categorizes it as positive, neutral, or negative sentiment. It then provides you with percentage breakdowns, a summary of the overall sentiment, and sample comments from each category. This process typically takes just a few seconds and gives you instant insights into how viewers are responding to the video content."
						}
					},
					{
						"@type": "Question",
						"name": "Is this tool free to use?",
						"acceptedAnswer": {
							"@type": "Answer",
							"text": "Yes, our YouTube sentiment analyzer is completely free to use! We believe in providing accessible tools for content creators, marketers, and researchers who want to understand audience sentiment without any cost barriers. You can analyze as many YouTube videos as you need without any subscription fees, hidden charges, or usage limits. Our goal is to democratize sentiment analysis and make it available to everyone, from individual YouTubers looking to understand their audience better to businesses conducting market research. Simply paste any YouTube URL and get instant, professional-grade sentiment analysis results at no cost."
						}
					},
					{
						"@type": "Question",
						"name": "Do you store any of my data?",
						"acceptedAnswer": {
							"@type": "Answer",
							"text": "No, we do not store any of your data or the YouTube comments we analyze. Our sentiment analyzer processes everything in real-time and immediately discards the data once the analysis is complete. We prioritize your privacy and data security - the YouTube URLs you submit, the comments we fetch, and the sentiment analysis results are never saved to our servers or databases. Each analysis is completely independent and temporary. When you submit a YouTube URL, we fetch the comments, analyze the sentiment, return the results to you, and then all data is automatically purged from our system. This ensures complete privacy and means that your analysis activity cannot be tracked or stored by us."
						}
					},
					{
						"@type": "Question",
						"name": "What types of YouTube videos can I analyze?",
						"acceptedAnswer": {
							"@type": "Answer",
							"text": "You can analyze any public YouTube video that has comments enabled. Our sentiment analyzer works with all types of content including vlogs, tutorials, music videos, product reviews, educational content, and entertainment videos. The tool supports various YouTube URL formats including standard watch URLs (youtube.com/watch?v=), shortened URLs (youtu.be/), and embedded URLs. For best results, we recommend analyzing videos that have at least 10-20 comments, as this provides a more representative sample for sentiment analysis. Videos with thousands of comments will give you the most comprehensive insights into audience sentiment and engagement patterns."
						}
					},
					{
						"@type": "Question",
						"name": "How accurate is the sentiment analysis?",
						"acceptedAnswer": {
							"@type": "Answer",
							"text": "Our sentiment analyzer uses OpenAI's GPT-4o model, which is one of the most advanced AI language models available. This ensures high accuracy in understanding context, detecting sarcasm, and interpreting complex emotional expressions that simpler sentiment analysis tools might miss. The AI has been trained on vast amounts of text data and can understand nuanced language patterns. While no automated sentiment analysis is 100% perfect, our tool typically achieves accuracy rates comparable to human analysts. The AI considers factors like emoji usage, capitalization, punctuation patterns, and contextual clues to make informed sentiment classifications. For the most reliable results, we analyze multiple comments and provide sample comments so you can verify the classifications yourself."
						}
					}
				]
			}
		]
	}
	</script>
</Layout>

<script>
	// Get DOM elements
	const form = document.getElementById('analysis-form') as HTMLFormElement;
	const urlInput = document.getElementById('youtube-url') as HTMLInputElement;
	const analyzeButton = document.getElementById('analyze-button') as HTMLButtonElement;
	const loadingState = document.getElementById('loading-state') as HTMLDivElement;
	const loadingText = document.getElementById('loading-text') as HTMLSpanElement;
	const errorState = document.getElementById('error-state') as HTMLDivElement;
	const errorMessage = document.getElementById('error-message') as HTMLSpanElement;
	const resultsContainer = document.getElementById('results-container') as HTMLDivElement;

	// Results elements
	const positivePercentage = document.getElementById('positive-percentage') as HTMLSpanElement;
	const neutralPercentage = document.getElementById('neutral-percentage') as HTMLSpanElement;
	const negativePercentage = document.getElementById('negative-percentage') as HTMLSpanElement;
	const positiveBar = document.getElementById('positive-bar') as HTMLDivElement;
	const neutralBar = document.getElementById('neutral-bar') as HTMLDivElement;
	const negativeBar = document.getElementById('negative-bar') as HTMLDivElement;
	const sentimentSummary = document.getElementById('sentiment-summary') as HTMLParagraphElement;
	const positiveComments = document.getElementById('positive-comments') as HTMLDivElement;
	const neutralComments = document.getElementById('neutral-comments') as HTMLDivElement;
	const negativeComments = document.getElementById('negative-comments') as HTMLDivElement;

	// Hide all states initially
	function hideAllStates() {
		loadingState.classList.add('hidden');
		errorState.classList.add('hidden');
		resultsContainer.classList.add('hidden');
	}

	// Show loading state
	function showLoading(message: string) {
		hideAllStates();
		loadingText.textContent = message;
		loadingState.classList.remove('hidden');
		analyzeButton.disabled = true;
	}

	// Show error state
	function showError(message: string) {
		hideAllStates();
		errorMessage.textContent = message;
		errorState.classList.remove('hidden');
		analyzeButton.disabled = false;
	}

	// Show results
	function showResults(data: any) {
		hideAllStates();
		
		// Update sentiment percentages and bars
		positivePercentage.textContent = `${data.positive}%`;
		neutralPercentage.textContent = `${data.neutral}%`;
		negativePercentage.textContent = `${data.negative}%`;
		
		// Animate bars
		setTimeout(() => {
			positiveBar.style.width = `${data.positive}%`;
			neutralBar.style.width = `${data.neutral}%`;
			negativeBar.style.width = `${data.negative}%`;
		}, 100);

		// Update summary
		sentimentSummary.textContent = data.summary;

		// Update sample comments
		updateComments(positiveComments, data.sampleComments.positive, 'text-green-700');
		updateComments(neutralComments, data.sampleComments.neutral, 'text-gray-700');
		updateComments(negativeComments, data.sampleComments.negative, 'text-red-700');

		resultsContainer.classList.remove('hidden');
		analyzeButton.disabled = false;
	}

	// Update comments in a container
	function updateComments(container: HTMLDivElement, comments: string[], textColor: string) {
		container.innerHTML = '';
		comments.forEach(comment => {
			const commentDiv = document.createElement('div');
			commentDiv.className = `text-sm ${textColor} bg-white p-3 rounded-lg border border-gray-200`;
			commentDiv.textContent = `"${comment}"`;
			container.appendChild(commentDiv);
		});
	}

	// Handle form submission
	form.addEventListener('submit', async (e) => {
		e.preventDefault();
		
		const youtubeUrl = urlInput.value.trim();
		if (!youtubeUrl) {
			showError('Please enter a YouTube URL');
			return;
		}

		try {
			// Step 1: Fetch comments
			showLoading('Fetching comments...');
			
			const commentsResponse = await fetch('/api/comments', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({ youtubeUrl }),
			});

			if (!commentsResponse.ok) {
				const errorData = await commentsResponse.json();
				throw new Error(errorData.error || 'Failed to fetch comments');
			}

			const commentsData = await commentsResponse.json();
			
			if (!commentsData.comments || commentsData.comments.length === 0) {
				throw new Error('No comments found for this video');
			}

			// Step 2: Analyze sentiment
			showLoading('Analyzing sentiment...');

			const sentimentResponse = await fetch('/api/sentiment', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({ comments: commentsData.comments }),
			});

			if (!sentimentResponse.ok) {
				const errorData = await sentimentResponse.json();
				throw new Error(errorData.error || 'Failed to analyze sentiment');
			}

			const sentimentData = await sentimentResponse.json();
			
			// Step 3: Show results
			showResults(sentimentData);

		} catch (error) {
			console.error('Analysis error:', error);
			showError(error instanceof Error ? error.message : 'An unexpected error occurred');
		}
	});

	// Cookie Notice Functionality
	const cookieNotice = document.getElementById('cookie-notice') as HTMLDivElement;
	const acceptCookies = document.getElementById('accept-cookies') as HTMLButtonElement;
	const declineCookies = document.getElementById('decline-cookies') as HTMLButtonElement;

	// Check if user has already made a choice
	const cookieChoice = localStorage.getItem('cookieChoice');
	
	if (!cookieChoice) {
		// Show cookie notice after a short delay
		setTimeout(() => {
			cookieNotice.classList.remove('translate-y-full');
		}, 1000);
	}

	// Handle accept cookies
	acceptCookies.addEventListener('click', () => {
		localStorage.setItem('cookieChoice', 'accepted');
		cookieNotice.classList.add('translate-y-full');
	});

	// Handle decline cookies
	declineCookies.addEventListener('click', () => {
		localStorage.setItem('cookieChoice', 'declined');
		cookieNotice.classList.add('translate-y-full');
	});
</script>
